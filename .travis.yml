dist: trusty
sudo: required
language: java
jdk:
- oraclejdk8
git:
  depth: 3
cache:
  directories:
  - "$HOME/.m2"
services:
- postgresql
before_script:
- psql -c 'create database frameworkeventstore;' -U postgres
- psql -c 'create database frameworkviewstore;' -U postgres
- psql -c 'create database frameworkfilestore;' -U postgres
- psql -c 'create database frameworksystem;' -U postgres
- psql -c 'create database fileservice;' -U postgres
- psql -c "CREATE USER framework WITH PASSWORD 'framework';" -U postgres
- psql -c "CREATE USER fileservice WITH PASSWORD 'fileservice';" -U postgres
addons:
  postgresql: '9.5'
  sonarcloud:
    organization: cjscommonplatform
    token:
      secure: KLvlBx5/glj8zVZRdEc577RE7Gfryrc4758eQ8LlxQJ3I9RR1/D5FH+j4yYem0eZu3ETGlcFeTdo4eQzIW1TqNDfRUY1sq4U5YfkIm2Rk2iazAF77M8I98skXuRHUc8GYXhnUADPfyp44qUE7l/Gbq+LiAvk8fY+J6Orsyz3aRYZFu9ZsWYOFpmKP2VgraWZSZ/BVXhWdhzvzQvtW8cC8e8S51fhIpneZMYjuRHmAFEqJW7oGI4t6kGCjv4mhf859leV78EOOXznv+X9gYKQbVUKVKOT/IRQ5cW1q3zBc8/2bcmF38LfCxnyUDktj+AGimzEXRKNW2WDc1iIu7NHHu+W9MEd6gZgJTF7t1cT6YrR+lyuh7u+74VeSyIucxn9JQHqYn+NH5859ABLAAkXj3mRng/UFPB32rZQV81v6r0QSwXEyz5+IO1wMy7fvR4sYya0/wXWCQvKZN2v1t4xHMl9zOHQ3ft64oKQKuzuoPDyvtaef9ntVMMXv/nZvBFg/qrdTB4KkUKBCdzypqhtiARhTjSH9MQgLkNssPhurDPKKboICra8LTM10vLw9euj7DSyDBeI3wrZaG7N/UFJJVsqq20cjpYwUOsvWeqQV+sjMYdyxld5AHrI1tja4dQG5UEkHlt9Fkp+9aP9iVIk75kqVv7XFCzdk/Jgvgu7gWM=
    github_token:
      secure: JpG965/I6WsGGNsRRcpVElwGa/5forl1sKWHOTf6kvZhNuJeOfNUSUldDK4y8aCaE1OuCq3om/umlswo54OhFwXHqGKf9dzyg9sIZteC/8ijeXl59Zb3Y/oC8XDh/TGKvfcIdnaHr1U8V4v38XL0QWOCSCXZkXHW2gdfzCTyWJDz1cZ0uiAWYQSu9fcWy0ilnPu/WraKV8epssKisuKyJWKzlfbCj7IRRNmOKrR+Gqh4GbnMxwD1EFpNYKjDV0YQj6TGNmwwjJinux9NQikHYZi7nLzSFf+kiELofCK8+IP833RBg4BMA6spk7ItDagqAd0D7FnIbc7qD59Jt8ZJ+7Hc7HK9hOr7Oe5DF2bacOIB4U/KQKi4joNfLofAOwJ1bqW0AdL1eDHQSjzpxSBQgx3Vi4cPavVBahjPj3mOHQqhHV9p9qcUO7YJdbizNCZf67Wl1vHNNU26VVed+04osHp7mZq1iehCiMV7WJh/LINJlE3e4zBK8ch2UdabzuhmCM3ab/In2bIkkslcpIL6v3Ed+KJ0E24woUv3ZgryO7jEBqA+YDo0XfUcVY9p6AZWnIo/ov/dEqZ6nf6HAFoDs8CiXMwmkTmG0fT6QF0Hmwj+kZVXXpiTQRCkfZsQsGsBZtvdUUV92oYQgKIu27hMbRj6h5LmytaEIDh4cEOUh8Q=
before_install:
- git clone https://github.com/CJSCommonPlatform/travis-settings.git target/travis-settings
- ln -sfT ${PWD}/target/travis-settings/settings.xml ${HOME}/.m2/settings.xml
- ln -sfT ${PWD}/target/travis-settings/mvnw mvnw
- ln -sft ${PWD} ${PWD}/target/travis-settings/.mvn
install: "${PWD}/target/travis-settings/java/install.sh -e -q -DexcludeGroupIds=uk.gov.justice.service,uk.gov.justice.services"
script: "${PWD}/target/travis-settings/java/script-install.sh coveralls:report sonar:sonar"
after_success: "${PWD}/target/travis-settings/java/after_success.sh"
notifications:
  slack:
    secure: fPlaMvrczZ2riJ4tjMOAqxSGj4JfxGlH/K08knLgG4T/n6EL4LN4+184Npz9XueNbV3m26WUrPkbXEiWXpqkKsbwcZXqqnFxGacGiyxv7LeBeQLYp7NFeARAyB5qDwUpjHlCPAEoAeyeGsZNrpui/wceY4j1tB7ObfdwbxLzAO0tekdbwitSaK1cc7V2sVHkBYr7ChuC+dVO1pshPw0EVTmzPioS8nfFKPaxWoMgyRAuYe7MD0U7DxNQ4Wzsb7tpfd5Oom1wLXyZ7M3wwSMMamIAAxHVG389Az6YvN7hXQggTGDawf/YwVOaoMR2bh7uHBCOiNZO1GbRTOA7IuTPwT7GsK94THRtfvqNm7RFBPkoD4657FATnk2o5c7QNTY3dAlYLsxLnS6mVTL/vAbqC7BbDHo/UGsxmOusQtKt8sRoL8pOCEInHaS3b88Osl7u7oYO/E4YTptdnkEe8tNyWWdx34nEUT0j1Mu/VAN38YcgTMUuiBU6chkMJ5BjIHisJlAAnBJ9VGgF9liqnigNwAGhbrHZPyAlKUX8HLejpD+t4aR0UaEvvauh6aHh4pYm0mZra4zOBC/lBDOXqsu5ajHL8LpHc6j+5FrmNwciiTVoxdud2S4c0U2ymr3L07ivX+UyhoraS9oSH3v7L73Q4NyvuAmD8Zc0xw/cR4Pff9c=
env:
  global:
  - PGPORT=5432
  - secure: UPI88KPr3E9kLMgbhEImAIDwOh05poEitez0zHx1540sDZsXPGgL4Q0WmfRm7QA0GmVY1aRSlu/AqF74Nr+jztIg9Py3wHtxrhLyg/G6gxu0gnFuecpZL+4mFyNRIVZUn53tR5ydcn8R30oPnQP+KHnRb5y12xPH9lfu6KB68FhlmLUqCKd9BAe/Q1FZNp21/smG9nWTpnU83yM1Oc9+8v1zCFbxU705FOSncpIlqHG10bi+6uWRg8STqmtNhTOj4Ymny7g3uDszQxdhjRRj30j6oOornhK2XgysdpDNdrnq0ez2A+gNhfzQn1uN258vhkkFONpb/3hfkjSbbZ1AG+iKtkCMp5n7kCiaraqO1rEqIwV7JQHJz/UKT7Az3glF/a2eYNRgAAXM9TJCz6xcjf6h5VnoMP/obusrjoA8hLzGYL8RXySvl2EH98adwRR9po36+itZuP7i8vW/HhzayCoSAjfbX7EgdUQClyvmSd5VELJpwGUpV+cQ1k1iEukpQb6eSiCCq/XXD7+IJRaSBV/dQVdWjVxz1EwAg8LfzYQiuRIPl15sKc+c8pA0/1juKyAArDV8CkKjaf9rCLdtEZtgWtAv6MgnnzDNrvZu2Hg901+32eR0jKEuHG4vybIU441YV/kScLSLlVQZjARQ3ZGiw7O4jT/Qlxxfs6qFuss=
  - secure: SWdo5DGTHhr0qUoDm+buUSNHYZq4yJsbgW8uPEilkY1O5Wer01f0QVVgggdhHrMaUeEQrsIIuLckaUW6SKLV4vBvjBEBk7AcGfz/AC98Hb0a8RXCxLKxR7xbXKMtggkmErUrBvhWqSbIQMmtf2823cdnUSl+ZZxm+gYtvJKQibjmNoVybfhMkXpGntBw+Zd5St3kitVbAJJMz4fKIcLpO0eZXDK6nTtMySjUlwve57IyFw0rvbV2YkHQijIXplpTtdyvVevAGCqLsahEhjAxJETakyYQP/XXT7dvm0QUemulWuQ1eugZJGGJRaE/x13f5yzg2MRFgVmEU3e4WY1V6KxS+PKo+RqHlW3TF/WqRiw7nLWjwo4UvO1a3jItokiDKQPzPYHYJbGg1jtpWiKHR2Tc41mXEiAr2z6IJAK/GfhkEW5YeXPvQmlIhVYg+WhewEXf1Xttv0xLyBIZlE54s6LtMKB+7HBTkdXso4ZeUClzBl5Q8MKlgaACDTs51PQpnHWV9leY8BBFnOtvoQU3YdXPoWR4s3O1WtT7BSF8n7E7Gj5ctXGZ6RHxGJJ/+WqoX5VDjYcc57+swbxsdd1YjYE8+83w/oKbGIgtnPDAvym4AcZnAnDrlQ5rWrJYHJkYk77o13NWNtMTRJNiMd+wmFMRsIbpQemmgx3GbbgN4Hg=
